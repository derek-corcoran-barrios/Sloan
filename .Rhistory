saveRDS(NBAOdds2016, "NBAOdds2016.rds")
#Load packages
library(ggplot2)
library(lubridate)
library(dplyr)
library(reshape2)
library(caret)
floor(sqrt(NCOL(NBAOdds2012_2015))
)
floor(sqrt(NCOL(NBAOdds2012_2015)))
colnames(NBAOdds2012_2015)
library(caret)
ctrl <- trainControl(method = "repeatedcv", number=10, repeats=3)
grid.2 <- expand.grid(interaction.depth = seq(1, 7, by = 2),
n.trees = seq(100, 1000, by = 50),
shrinkage = c(0.001, 0.01, 0.1),
n.minobsinnode=c(1,3,5,7,10))
set.seed(7)
modelGbmforcast.nopace <- train(x = NBAOdds2012_2015[,14:15],y = NBAOdds2012_2015[,12], method = "gbm",  preProcess = c("center", "scale"), verbose = FALSE, trControl = ctrl, tuneGrid = grid.2)
gbmcaretforecast <- predict(modelGbmforcast.nopace, NBAOdds2016[,14:15])
modelGbmforcast.nopace
kable(grid.2)
View(grid.2)
ggplot(modelGbmforcast.nopace)
shotDataTotal2016 <- readRDS("shotDataTotal2016.rds")
View(shotDataTotal2016)
NCOL(shotDataTotal2016)
NROW(shotDataTotal2016)
shotDataTotal2015 <- readRDS("shotDataTotal2015.rds")
shotDataTotal2014 <- readRDS("shotDataTotal2014.rds")
shotDataTotal2013 <- readRDS("shotDataTotal2013.rds")
shotDataTotal2012 <- readRDS("shotDataTotal2012.rds")
NROW(shotDataTotal2016) + NROW(shotDataTotal2015) + NROW(shotDataTotal2014)
NROW(shotDataTotal2016) + NROW(shotDataTotal2015) + NROW(shotDataTotal2014) + NROW(shotDataTotal2013) + NROW(shotDataTotal2012)
NROW(shotDataTotal2015) + NROW(shotDataTotal2014) + NROW(shotDataTotal2013) + NROW(shotDataTotal2012)
NROW(NBAOdds)
NROW(NBAOdds2012_2015)
datos2016 <- read.csv("~/Sloan/datos2016.csv", row.names=1)
summary(datos2016)
max(datos2016)
min(datos2016)
min(datos2015)
max(datos2015)
max(datos2014)
max(datos2013)
max(datos2012)
min(datos2012)
min(datos2013)
min(datos2014)
min(datos2015)
min(datos2016)
library(caret)
c(1, seq(50, 1000, by = 50))
grid.2<- expand.grid(interaction.depth = seq(1, 7, by = 2),
n.trees = c(1, seq(50, 1000, by = 50)),
shrinkage = c(0.001, 0.01, 0.1),
n.minobsinnode=c(1,5,10))
set.seed(7)
modelGbmforcast2 <- train(x = NBAOdds2012_2015[,14:15],y = NBAOdds2012_2015[,12], method = "gbm",  preProcess = c("center", "scale"), verbose = FALSE, trControl = ctrl, tuneGrid = grid.2)
modelGbmforcast2
shotURLtotal <- paste("http://stats.nba.com/stats/shotchartdetail?CFID=33&CFPARAMS=2016-17&ContextFilter=&ContextMeasure=FGA&DateFrom=&DateTo=&GameID=&GameSegment=&LastNGames=0&LeagueID=00&Location=&MeasureType=Base&Month=0&OpponentTeamID=0&Outcome=&PaceAdjust=N&PerMode=PerGame&Period=0&PlayerID=0&PlusMinus=N&Position=&Rank=N&RookieYear=&Season=2016-17&SeasonSegment=&SeasonType=Regular+Season&TeamID=0&VsConference=&VsDivision=&mode=Advanced&showDetails=0&showShots=1&showZones=0", sep = "")
shotURLtotal
shotURLtotal <- paste("http://stats.nba.com/stats/shotchartdetail?CFID=33&CFPARAMS=2011-12&ContextFilter=&ContextMeasure=FGA&DateFrom=&DateTo=&GameID=&GameSegment=&LastNGames=0&LeagueID=00&Location=&MeasureType=Base&Month=0&OpponentTeamID=0&Outcome=&PaceAdjust=N&PerMode=PerGame&Period=0&PlayerID=0&PlusMinus=N&Position=&Rank=N&RookieYear=&Season=2011-12&SeasonSegment=&SeasonType=Regular+Season&TeamID=0&VsConference=&VsDivision=&mode=Advanced&showDetails=0&showShots=1&showZones=0", sep = "")
shotURLtotal
citation()
citation("raster")
library(rjson)
library(grid)
library(gridExtra)
library(png)
library(RCurl)
library(ggplot2)
library(jpeg)
library(hexbin)
library(sp)
library(knitr)
library(raster)
library(rasterVis)
library(dplyr)
court <- readRDS("court.rds")
shotDatafDef2016 <- readRDS("shotDatafDef2016.rds")
shotDataTotal2016 <- readRDS("shotDataTotal2016.rds")
shotDatafDef2013 <- readRDS("shotDatafDef2013.rds")
shotDataTotal2013 <- readRDS("shotDataTotal2013.rds")
ShotComparisonGraph <- function(OffTeam, DefTown, SeasondataOff, SeasonDataDef, nbins = 30, maxsize = 7, quant = 0.7) {
#Filter the offensive data of the Offensive Team
Off <- filter(SeasondataOff, TEAM_NAME == OffTeam)
#Filter the Deffensive data of the Defensive team
deff <- SeasonDataDef[names(SeasonDataDef) == DefTown][[1]]
#Get the maximum and minumum values for x and y
xbnds <- range(c(SeasondataOff$LOC_X, deff$LOC_X))
ybnds <- range(c(SeasondataOff$LOC_Y, deff$LOC_Y))
#Make hexbin dataframes out of the teams
makeHexData <- function(df) {
h <- hexbin(df$LOC_X, df$LOC_Y, nbins, xbnds = xbnds, ybnds = ybnds, IDs = TRUE)
data.frame(hcell2xy(h),
PPS = tapply(as.numeric(as.character(df$SHOT_MADE_FLAG))*ifelse(tolower(df$SHOT_TYPE) == "3pt field goal", 3, 2), h@cID, FUN = function(z) sum(z)/length(z)),
ST = tapply(df$SHOT_MADE_FLAG, h@cID, FUN = function(z) length(z)),
cid = h@cell)
}
##Total NBA data
Totalhex <- makeHexData(SeasondataOff)
##Defensive team data
Defhex <- makeHexData(deff)
##Offensive team data
Offhex <- makeHexData(Off)
#Merge offensive and deffensive data with total data by Cell id
DeffbyCell <- merge(Totalhex, Defhex, by = "cid", all = T)
OffByCell <- merge(Totalhex, Offhex, by = "cid", all = T)
##  when calculating the difference empty cells should count as 0
DeffbyCell$PPS.x[is.na(DeffbyCell$PPS.x)] <- 0
DeffbyCell$PPS.y[is.na(DeffbyCell$PPS.y)] <- 0
DeffbyCell$ST.y[is.na(DeffbyCell$ST.y)] <- 0
OffByCell$PPS.x[is.na(OffByCell$PPS.x)] <- 0
OffByCell$PPS.y[is.na(OffByCell$PPS.y)] <- 0
OffByCell$ST.y[is.na(OffByCell$ST.y)] <- 0
#  make a "difference" data.frame
DiffDeff <- data.frame(x = ifelse(is.na(DeffbyCell$x.x), DeffbyCell$x.y, DeffbyCell$x.x),
y = ifelse(is.na(DeffbyCell$y.x), DeffbyCell$y.y, DeffbyCell$y.x),
PPS= DeffbyCell$PPS.y - DeffbyCell$PPS.x,
cid= DeffbyCell$cid,
ST = DeffbyCell$ST.y)
DiffOff <- data.frame(x = ifelse(is.na(OffByCell$x.x), OffByCell$x.y, OffByCell$x.x),
y = ifelse(is.na(OffByCell$y.x), OffByCell$y.y, OffByCell$y.x),
PPS= OffByCell$PPS.y - OffByCell$PPS.x,
ST = OffByCell$ST.x,
cid = OffByCell$cid,
ST = OffByCell$ST.y)
#make team comparisons
Comparison <- merge(DiffOff, DiffDeff, by = "cid", all = T)
Comparison <- Comparison[,-c(6:7)]
Comparison$Diff <- c(Comparison$PPS.x + Comparison$PPS.y)
PPSAA <- weighted.mean((Comparison$PPS.x + Comparison$PPS.y), Comparison$ST.x)
#Legend extractor
g_legend <- function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
OFFLEG <- ggplot(DiffOff) + annotation_custom(court, -250, 250, -52, 418) + geom_point(aes(x = x, y = y, color = PPS, size = ST), stat = "identity") +
coord_fixed()  +theme(line = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.title = element_blank(),
plot.title = element_text(size = 17, lineheight = 1.2, face = "bold"))+ scale_size(range = c(0, maxsize)) +scale_color_gradient2(low = "blue", high = "red", name = "APPS") + ylim(c(-51, 400))+ theme(legend.position="bottom") +  ggtitle(paste(OffTeam, "Offensive\n Shot Chart", sep = " "))
leg<-g_legend(OFFLEG)
DiffOff <- filter(DiffOff, ST > quantile(DiffOff$ST, probs = quant))
DiffDeff <- filter(DiffDeff, ST > quantile(DiffDeff$ST, probs = quant))
Comparison <- filter(Comparison, ST.x > quantile(Comparison$ST.x, probs = quant))
OFF <- ggplot(DiffOff) + annotation_custom(court, -250, 250, -52, 418) + geom_point(aes(x = x, y = y, color = PPS, size = ST), stat = "identity") +
coord_fixed()  +theme(line = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.title = element_blank(),
plot.title = element_text(size = 17, lineheight = 1.2, face = "bold"))+ scale_size(range = c(0, maxsize)) + scale_color_gradient2(low = "blue", high = "red", name = "APPS") + ylim(c(-51, 400))+ theme(legend.position="none") +  ggtitle(paste(OffTeam, "Offensive\n Shot Chart", sep = " "))
DEF <- ggplot(DiffDeff)  + annotation_custom(court, -250, 250, -52, 418) + geom_point(aes(x = x, y = y, color = PPS, size = ST), stat = "identity") +
coord_fixed()  +theme(line = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.title = element_blank(),
plot.title = element_text(size = 17, lineheight = 1.2, face = "bold"))+ scale_size(range = c(0, maxsize)) + scale_color_gradient2(low = "blue", high = "red", name = "APPS") + ylim(c(-51, 400))+ theme(legend.position="none") + ggtitle(paste(DefTown, "defensive\n Shot Chart", sep = " "))
COMP <- ggplot(Comparison) + annotation_custom(court, -250, 250, -52, 418) + geom_point(aes(x = x.x, y = y.x, color = Diff, size = ST.x), stat = "identity") +
coord_fixed()  +theme(line = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.title = element_blank(),
plot.title = element_text(size = 17, lineheight = 1.2, face = "bold"))+ scale_size(range = c(0, maxsize)) + scale_color_gradient2(low = "blue", high = "red", name = "APPS")+ ylim(c(-51, 400))+ theme(legend.position="none") + ggtitle("Comparison\n Shot Chart")
charts <- arrangeGrob(DEF,OFF, COMP, ncol = 3)
p <- grid.arrange(arrangeGrob(arrangeGrob(DEF,OFF, COMP, ncol = 3),leg,ncol=1,heights=c(7/8,1/8)))
return(list(Off = DiffOff, deff = DiffDeff, Comparison = Comparison, Total = Totalhex, PPSAA = PPSAA, p = p, leg = leg, charts = charts))
}
Com1 <- ShotComparisonGraph(OffTeam = "Golden State Warriors", DefTown = "Cleveland", SeasondataOff = shotDataTotal2016, SeasonDataDef = shotDatafDef2016, nbins = 30, quant = 0.7)
str(Com1)
View(Com1$Off)
hex_coord_df <- function(x, y, width, height, size = 1) {
# like hex_coord but returns a dataframe of vertices grouped by an id variable
dx <- size * width / 6
dy <- size * height / 2 / sqrt(3)
hex_x <- rbind(x - 2 * dx, x - dx, x + dx, x + 2 * dx, x + dx, x - dx)
hex_y <- rbind(y, y + dy, y + dy, y, y - dy, y - dy)
id    <- rep(1:length(x), each=6)
data.frame(cbind(x=as.vector(hex_x), y=as.vector(hex_y), id))
}
DF34 <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1)
DF34
colnames(DF34)
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id))
DF34 <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =0.2)
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id))
DF34 <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =0.1)
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id))
hist(Com1$Off$ST.1)
hist(log(Com1$Off$ST.1))
hex_coord_df <- function(x, y, width, height, size = 1) {
# like hex_coord but returns a dataframe of vertices grouped by an id variable
dx <- log(size * width / 6)
dy <- log(size * height / 2 / sqrt(3))
hex_x <- rbind(x - 2 * dx, x - dx, x + dx, x + 2 * dx, x + dx, x - dx)
hex_y <- rbind(y, y + dy, y + dy, y, y - dy, y - dy)
id    <- rep(1:length(x), each=6)
data.frame(cbind(x=as.vector(hex_x), y=as.vector(hex_y), id))
}
DF34 <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id))
?geom_polygon
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id), fill = Com1$Off$PPS)
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id), fill = rep(Com1$Off$PPS, each = 5))
head(DF34)
head(DF34, 8)
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id), fill = rep(Com1$Off$PPS, each = 6))
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id))
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id), fill = rep(Com1$Off$PPS, each = 6))
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id))
library(rjson)
library(grid)
library(gridExtra)
library(png)
library(RCurl)
library(ggplot2)
library(jpeg)
library(hexbin)
library(sp)
library(knitr)
library(raster)
library(rasterVis)
library(dplyr)
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id))
library(rjson)
library(grid)
library(gridExtra)
library(png)
library(RCurl)
library(ggplot2)
library(jpeg)
library(hexbin)
library(sp)
library(knitr)
library(raster)
library(rasterVis)
library(dplyr)
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id))
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id), fill = rep(Com1$Off$PPS, each = 6))
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id), fill = "red")
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id), fill = rep(Com1$Off$PPS, each = 6))
Com1$Total
Com1$Comparison
Com1$Comparison$Diff
hist(Com1$Comparison$Diff)
summary(Com1$Comparison$Diff)
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id))
ggplot(DF34, aes(x=DF34$x, y = DF34$y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id))
colnames(DF34)
ggplot(DF34, aes(x=DF34$x, y = DF34$y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id))
Com1$Off$PPS
ncols(DF34)
ncol(DF34)
nrow(DF34)
nrow(DF34)/218
nrow(DF34)/219
rep(Com1$Off$PPS, each = 6)
hist(Com1$Off$PPS)
summary(Com1$Off$PPS)
hist(Com1$Off$PPS)
ifelse(Com1$Off$PPS > -1 & < 0.5, "red", "else")
ifelse(Com1$Off$PPS < 0.5, "red", "else")
ifelse(Com1$Off$PPS < -0.5, "red", "else")
ifelse(Com1$Off$PPS < -0.5, "blue", "yellow")
DF34 <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DF34$PPS <- rep(Com1$Off$PPS, each = 6)
DF34$color <- ifelse(Com1$Off$PPS < -0.5, "blue", "yellow")
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id, fill = color))
DF34 <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DF34$PPS <- rep(Com1$Off$PPS, each = 6)
DF34$color <- ifelse(Com1$Off$PPS < -0.5, "blue", "yellow")
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id, fill = "blue"))
DF34 <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DF34$PPS <- rep(Com1$Off$PPS, each = 6)
DF34$color <- ifelse(Com1$Off$PPS < -0.5, "blue", "yellow")
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id, fill = "red"))
DF34 <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DF34$PPS <- rep(Com1$Off$PPS, each = 6)
DF34$color <- ifelse(Com1$Off$PPS < -0.5, "blue", "yellow")
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id, fill = "blue"))
class(ifelse(Com1$Off$PPS < -0.5, "blue", "yellow"))
Com1$Off$PPS >-0.5 & <0.25
(Com1$Off$PPS >-0.5 & <0.25)
(Com1$Off$PPS >-0.5)
(Com1$Off$PPS >-0.5 & < 0)
(Com1$Off$PPS >-0.5 && < 0)
dplyr::filter(Com1$Off$PPS, >-0.5)
dplyr::filter(Com1$Off, PPS >-0.5)
ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < 0, 1, NA)
ggplot(DF34, aes(x=DF34$x, y = DF34$y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id))
DF34 <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DF34$PPS <- rep(Com1$Off$PPS, each = 6)
DF34$color <- ifelse(Com1$Off$PPS < -0.5, "blue", "yellow")
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id, fill = "blue"))
DF34 <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DF34$PPS <- rep(Com1$Off$PPS, each = 6)
DF34$color <- ifelse(Com1$Off$PPS < -0.5, "blue", "yellow")
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id, fill = "red"))
DF34 <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DF34$PPS <- rep(Com1$Off$PPS, each = 6)
DF34$color <- ifelse(Com1$Off$PPS < -0.5, "blue", "yellow")
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id), fill = "red")
DF34 <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DF34$PPS <- rep(Com1$Off$PPS, each = 6)
DF34$color <- ifelse(Com1$Off$PPS < -0.5, "blue", "yellow")
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id), fill = "blue")
DF34$color <- ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < 0, 1, NA)
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id), fill = DF34$color) + scale_fill_manual(values = c("0"="blue3","1" = "cyan3","2"="yellow","3"="gold","4"="orange","5"="red"))
DF34$color
DF34$color <- ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < 0, "blue", "red")
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id), fill = DF34$color) + scale_fill_manual(values = c("0"="blue3","1" = "cyan3","2"="yellow","3"="gold","4"="orange","5"="red"))
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id), fill = DF34$color)
ggplot(DF34, aes(x=DF34$x, y = DF34$y)) + geom_polygon(aes(group = id, fill =color))
ggplot(DF34, aes(x=DF34$x, y = DF34$y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DF34$color)
DF34$color <- ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < 0, "cyan", "red"))
ggplot(DF34, aes(x=DF34$x, y = DF34$y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DF34$color)
DF34$color <- ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < 0, "cyan", ifelse(Com1$Off$PPS >= 0 & Com1$Off$PPS <= 0.5, "gold", "red")))
ggplot(DF34, aes(x=DF34$x, y = DF34$y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DF34$color)
DF34$color <- ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < -0.25, "cyan", ifelse(Com1$Off$PPS >= -0.25 & Com1$Off$PPS <= 0, "gold", ifelse(Com1$Off$PPS > 0 &Com1$Off$PPS < 0.25, "orange", "red"))))
ggplot(DF34, aes(x=DF34$x, y = DF34$y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DF34$color)
DF34$color <- ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < -0.25, "cyan", ifelse(Com1$Off$PPS >= -0.25 & Com1$Off$PPS <= 0.25, "gold", ifelse(Com1$Off$PPS > 0.25 &Com1$Off$PPS < 0.5, "orange", "red"))))
ggplot(DF34, aes(x=DF34$x, y = DF34$y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DF34$color)
DFOFF <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DFOFF$PPS <- rep(Com1$Off$PPS, each = 6)
DFOFF$color <- ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < -0.25, "cyan", ifelse(Com1$Off$PPS >= -0.25 & Com1$Off$PPS <= 0.25, "gold", ifelse(Com1$Off$PPS > 0.25 &Com1$Off$PPS < 0.5, "orange", "red"))))
ggplot(DFOFF, aes(x=DF34$x, y = DF34$y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DF34$color)
DFOFF <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DFOFF$PPS <- rep(Com1$Off$PPS, each = 6)
DFOFF$color <- ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < -0.25, "cyan", ifelse(Com1$Off$PPS >= -0.25 & Com1$Off$PPS <= 0.25, "gold", ifelse(Com1$Off$PPS > 0.25 &Com1$Off$PPS < 0.5, "orange", "red"))))
ggplot(DFOFF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DF34$color)
DFOFF <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DFOFF$PPS <- rep(Com1$Off$PPS, each = 6)
DFOFF$color <- ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < -0.25, "cyan", ifelse(Com1$Off$PPS >= -0.25 & Com1$Off$PPS <= 0.25, "gold", ifelse(Com1$Off$PPS > 0.25 &Com1$Off$PPS < 0.5, "orange", "red"))))
ggplot(DFOFF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFOFF$color)
DFDEF <- hex_coord_df(Com1$deff$x, Com1$deff, Com1$deff$ST, Com1$deff$ST, size =1)
DFDEF$PPS <- rep(Com1$deff$PPS, each = 6)
DFDEF$color <- ifelse(Com1$deff$PPS <= -0.5, "blue",ifelse(Com1$deff$PPS > -0.5 & Com1$deff$PPS < -0.25, "cyan", ifelse(Com1$deff$PPS >= -0.25 & Com1$deff$PPS <= 0.25, "gold", ifelse(Com1$deff$PPS > 0.25 &Com1$deff$PPS < 0.5, "orange", "red"))))
ggplot(DFDEF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDEF$color)
DFDEF <- hex_coord_df(Com1$deff$x, Com1$deff, Com1$deff$ST, Com1$deff$ST, size =1)
DFDEF
colnames(DFDEF)
ggplot(DFDEF, aes(x=y.x, y = y.y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDEF$color)
DFDEF <- hex_coord_df(Com1$deff$x, Com1$deff$y, Com1$deff$ST, Com1$deff$ST, size =1)
colnames(DFDEF)
DFDEF <- hex_coord_df(Com1$deff$x, Com1$deff$y, Com1$deff$ST, Com1$deff$ST, size =1)
DFDEF$PPS <- rep(Com1$deff$PPS, each = 6)
DFDEF$color <- ifelse(Com1$deff$PPS <= -0.5, "blue",ifelse(Com1$deff$PPS > -0.5 & Com1$deff$PPS < -0.25, "cyan", ifelse(Com1$deff$PPS >= -0.25 & Com1$deff$PPS <= 0.25, "gold", ifelse(Com1$deff$PPS > 0.25 &Com1$deff$PPS < 0.5, "orange", "red"))))
ggplot(DFDEF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDEF$color)
ggplot(DFOFF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFOFF$color)
(Com1$Comparison$x
)
(colnames(Com1$Comparison))
Com1$Off$ST
Com1$Off$ST
DFDEF <- hex_coord_df(Com1$deff$x, Com1$deff$y, Com1$deff$ST, Com1$deff$ST, size =1)
DFDEF$PPS <- rep(Com1$deff$PPS, each = 6)
DFDEF$color <- ifelse(Com1$deff$PPS <= -0.5, "blue",ifelse(Com1$deff$PPS > -0.5 & Com1$deff$PPS < -0.25, "cyan", ifelse(Com1$deff$PPS >= -0.25 & Com1$deff$PPS <= 0.25, "gold", ifelse(Com1$deff$PPS > 0.25 &Com1$deff$PPS < 0.5, "orange", "red"))))
ggplot(DFDEF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDEF$color)
DFOFF <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST, Com1$Off$ST, size =1)
DFOFF$PPS <- rep(Com1$Off$PPS, each = 6)
DFOFF$color <- ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < -0.25, "cyan", ifelse(Com1$Off$PPS >= -0.25 & Com1$Off$PPS <= 0.25, "gold", ifelse(Com1$Off$PPS > 0.25 &Com1$Off$PPS < 0.5, "orange", "red"))))
ggplot(DFOFF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFOFF$color)
Com1$Off$ST
Com1$Off$ST
DFOFF <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DFOFF$PPS <- rep(Com1$Off$PPS, each = 6)
DFOFF$color <- ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < -0.25, "cyan", ifelse(Com1$Off$PPS >= -0.25 & Com1$Off$PPS <= 0.25, "gold", ifelse(Com1$Off$PPS > 0.25 &Com1$Off$PPS < 0.5, "orange", "red"))))
ggplot(DFOFF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFOFF$color)
DFDEF <- hex_coord_df(Com1$deff$x, Com1$deff$y, Com1$deff$ST, Com1$deff$ST, size =1)
DFDEF$PPS <- rep(Com1$deff$PPS, each = 6)
DFDEF$color <- ifelse(Com1$deff$PPS <= -0.5, "blue",ifelse(Com1$deff$PPS > -0.5 & Com1$deff$PPS < -0.25, "cyan", ifelse(Com1$deff$PPS >= -0.25 & Com1$deff$PPS <= 0.25, "gold", ifelse(Com1$deff$PPS > 0.25 &Com1$deff$PPS < 0.5, "orange", "red"))))
ggplot(DFDEF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDEF$color)
DFOFF$PPS <- rep(Com1$Comparison$Diff, each = 6)
DFDIF <- hex_coord_df(Com1$Comparison$x.x, Com1$Comparison$y.y, Com1$Comparison$ST.x, Com1$Comparison$ST.x, size =1)
DFDIF$Dif <- rep(Com1$Comparison$Diff, each = 6)
hist(Com1$Comparison$Diff)
DFDIF <- hex_coord_df(Com1$Comparison$x.x, Com1$Comparison$y.y, Com1$Comparison$ST.x, Com1$Comparison$ST.x, size =1)
DFDIF$Dif <- rep(Com1$Comparison$Diff, each = 6)
DFDif$color <- ifelse(Com1$Comparison$Diff <= -0.5, "blue",ifelse(Com1$Comparison$Diff > -0.5 & Com1$Comparison$Diff < -0.25, "cyan", ifelse(Com1$Comparison$Diff >= -0.25 &Com1$Comparison$Diff <= 0.25, "gold", ifelse(Com1$Comparison$Diff > 0.25 &Com1$Comparison$Diff < 0.5, "orange", "red"))))
DFDIF <- hex_coord_df(Com1$Comparison$x.x, Com1$Comparison$y.y, Com1$Comparison$ST.x, Com1$Comparison$ST.x, size =1)
DFDIF$Dif <- rep(Com1$Comparison$Diff, each = 6)
colnames(DFDIF)
DFDif$color <- ifelse(Com1$Comparison$Diff <= -0.5, "blue",ifelse(Com1$Comparison$Diff > -0.5 & Com1$Comparison$Diff < -0.25, "cyan", ifelse(Com1$Comparison$Diff >= -0.25 &Com1$Comparison$Diff <= 0.25, "gold", ifelse(Com1$Comparison$Diff > 0.25 &Com1$Comparison$Diff < 0.5, "orange", "red"))))
DFOFF <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DFOFF$PPS <- rep(Com1$Off$PPS, each = 6)
DFOFF$color <- ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < -0.25, "cyan", ifelse(Com1$Off$PPS >= -0.25 & Com1$Off$PPS <= 0.25, "gold", ifelse(Com1$Off$PPS > 0.25 &Com1$Off$PPS < 0.5, "orange", "red"))))
ggplot(DFOFF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFOFF$color)
Com1$Comparison$Diff
summary(Com1$Comparison$Diff)
Com1$Comparison$Diff <= -0.5
Com1$Comparison$Diff > -0.5 & Com1$Comparison$Diff < -0.25
Com1$Comparison$Diff > -0.5 & Com1$Comparison$Diff < -0.25
Com1$Comparison$Diff >= -0.25 &Com1$Comparison$Diff <= 0.25
Com1$Comparison$Diff > -0.5 & Com1$Comparison$Diff < -0.25, "cyan", ifelse(Com1$Comparison$Diff >= -0.25 &Com1$Comparison$Diff <= 0.25, "gold", ifelse(Com1$Comparison$Diff > 0.25 & Com1$Comparison$Diff < 0.5
Com1$Comparison$Diff > 0.25 & Com1$Comparison$Diff < 0.5
ifelse(Com1$Comparison$Diff <= -0.5, "blue",
ifelse(Com1$Comparison$Diff > -0.5 & Com1$Comparison$Diff < -0.25, "cyan",
ifelse(Com1$Comparison$Diff >= -0.25 &Com1$Comparison$Diff <= 0.25, "gold",
ifelse(Com1$Comparison$Diff > 0.25 & Com1$Comparison$Diff < 0.5, "orange", "red"))))
DFDEF <- hex_coord_df(Com1$deff$x, Com1$deff$y, Com1$deff$ST, Com1$deff$ST, size =1)
DFDEF$PPS <- rep(Com1$deff$PPS, each = 6)
DFDEF$color <- ifelse(Com1$deff$PPS <= -0.5, "blue",ifelse(Com1$deff$PPS > -0.5 & Com1$deff$PPS < -0.25, "cyan", ifelse(Com1$deff$PPS >= -0.25 & Com1$deff$PPS <= 0.25, "gold", ifelse(Com1$deff$PPS > 0.25 &Com1$deff$PPS < 0.5, "orange", "red"))))
DFDEF
DFDEF$color <- rep(ifelse(Com1$deff$PPS <= -0.5, "blue",ifelse(Com1$deff$PPS > -0.5 & Com1$deff$PPS < -0.25, "cyan", ifelse(Com1$deff$PPS >= -0.25 & Com1$deff$PPS <= 0.25, "gold", ifelse(Com1$deff$PPS > 0.25 &Com1$deff$PPS < 0.5, "orange", "red")))), each = 6)
DFDEF
ggplot(DFDEF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDEF$color)
DFOFF <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DFOFF$PPS <- rep(Com1$Off$PPS, each = 6)
DFOFF$color <- rep(ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < -0.25, "cyan", ifelse(Com1$Off$PPS >= -0.25 & Com1$Off$PPS <= 0.25, "gold", ifelse(Com1$Off$PPS > 0.25 &Com1$Off$PPS < 0.5, "orange", "red")))), each = 6)
ggplot(DFOFF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFOFF$color)
DFDIF <- hex_coord_df(Com1$Comparison$x.x, Com1$Comparison$y.y, Com1$Comparison$ST.x, Com1$Comparison$ST.x, size =1)
DFDIF$Dif <- rep(Com1$Comparison$Diff, each = 6)
DFDif$color <- rep(ifelse(Com1$Comparison$Diff <= -0.5, "blue",
ifelse(Com1$Comparison$Diff > -0.5 & Com1$Comparison$Diff < -0.25, "cyan",
ifelse(Com1$Comparison$Diff >= -0.25 &Com1$Comparison$Diff <= 0.25, "gold",
ifelse(Com1$Comparison$Diff > 0.25 & Com1$Comparison$Diff < 0.5, "orange", "red")))), each = 6)
DFDIF <- hex_coord_df(Com1$Comparison$x.x, Com1$Comparison$y.y, Com1$Comparison$ST.x, Com1$Comparison$ST.x, size =1)
DFDIF$Dif <- rep(Com1$Comparison$Diff, each = 6)
DFDIF$color <- rep(ifelse(Com1$Comparison$Diff <= -0.5, "blue",
ifelse(Com1$Comparison$Diff > -0.5 & Com1$Comparison$Diff < -0.25, "cyan",
ifelse(Com1$Comparison$Diff >= -0.25 &Com1$Comparison$Diff <= 0.25, "gold",
ifelse(Com1$Comparison$Diff > 0.25 & Com1$Comparison$Diff < 0.5, "orange", "red")))), each = 6)
ggplot(DFDIF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDIF$color)
summary(Com1$Comparison)
DFDIF <- hex_coord_df(Com1$Comparison$x.x, Com1$Comparison$y.y, Com1$Comparison$ST.x, Com1$Comparison$ST.y, size =1)
DFDIF$Dif <- rep(Com1$Comparison$Diff, each = 6)
DFDIF$color <- rep(ifelse(Com1$Comparison$Diff <= -0.5, "blue",
ifelse(Com1$Comparison$Diff > -0.5 & Com1$Comparison$Diff < -0.25, "cyan",
ifelse(Com1$Comparison$Diff >= -0.25 &Com1$Comparison$Diff <= 0.25, "gold",
ifelse(Com1$Comparison$Diff > 0.25 & Com1$Comparison$Diff < 0.5, "orange", "red")))), each = 6)
ggplot(DFDIF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDIF$color)
DFDIF <- hex_coord_df(Com1$Comparison$x.x, Com1$Comparison$y.y, Com1$Comparison$ST.y, Com1$Comparison$ST.y, size =1)
DFDIF$Dif <- rep(Com1$Comparison$Diff, each = 6)
DFDIF$color <- rep(ifelse(Com1$Comparison$Diff <= -0.5, "blue",
ifelse(Com1$Comparison$Diff > -0.5 & Com1$Comparison$Diff < -0.25, "cyan",
ifelse(Com1$Comparison$Diff >= -0.25 &Com1$Comparison$Diff <= 0.25, "gold",
ifelse(Com1$Comparison$Diff > 0.25 & Com1$Comparison$Diff < 0.5, "orange", "red")))), each = 6)
ggplot(DFDIF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDIF$color)
DFOFF <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DFOFF$PPS <- rep(Com1$Off$PPS, each = 6)
DFOFF$color <- rep(ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < -0.25, "cyan", ifelse(Com1$Off$PPS >= -0.25 & Com1$Off$PPS <= 0.25, "gold", ifelse(Com1$Off$PPS > 0.25 &Com1$Off$PPS < 0.5, "orange", "red")))), each = 6)
ggplot(DFOFF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFOFF$color)
DFDEF <- hex_coord_df(Com1$deff$x, Com1$deff$y, Com1$deff$ST, Com1$deff$ST, size =1)
DFDEF$PPS <- rep(Com1$deff$PPS, each = 6)
DFDEF$color <- rep(ifelse(Com1$deff$PPS <= -0.5, "blue",ifelse(Com1$deff$PPS > -0.5 & Com1$deff$PPS < -0.25, "cyan", ifelse(Com1$deff$PPS >= -0.25 & Com1$deff$PPS <= 0.25, "gold", ifelse(Com1$deff$PPS > 0.25 &Com1$deff$PPS < 0.5, "orange", "red")))), each = 6)
ggplot(DFDEF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDEF$color)
DFDIF <- hex_coord_df(Com1$Comparison$x.x, Com1$Comparison$y.y, Com1$Comparison$ST.y, Com1$Comparison$ST.y, size =1)
DFDIF$Dif <- rep(Com1$Comparison$Diff, each = 6)
DFDIF$color <- rep(ifelse(Com1$Comparison$Diff <= -0.5, "blue",
ifelse(Com1$Comparison$Diff > -0.5 & Com1$Comparison$Diff < -0.25, "cyan",
ifelse(Com1$Comparison$Diff >= -0.25 &Com1$Comparison$Diff <= 0.25, "gold",
ifelse(Com1$Comparison$Diff > 0.25 & Com1$Comparison$Diff < 0.5, "orange", "red")))), each = 6)
ggplot(DFDIF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDIF$color)
Com1 <- ShotComparisonGraph(OffTeam = "Philadelphia 76ers", DefTown = "San Antonio", SeasondataOff = shotDataTotal2016, SeasonDataDef = shotDatafDef2016, nbins = 30, quant = 0.7)
DFOFF <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DFOFF$PPS <- rep(Com1$Off$PPS, each = 6)
DFOFF$color <- rep(ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < -0.25, "cyan", ifelse(Com1$Off$PPS >= -0.25 & Com1$Off$PPS <= 0.25, "gold", ifelse(Com1$Off$PPS > 0.25 &Com1$Off$PPS < 0.5, "orange", "red")))), each = 6)
ggplot(DFOFF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFOFF$color)
DFDEF <- hex_coord_df(Com1$deff$x, Com1$deff$y, Com1$deff$ST, Com1$deff$ST, size =1)
DFDEF$PPS <- rep(Com1$deff$PPS, each = 6)
DFDEF$color <- rep(ifelse(Com1$deff$PPS <= -0.5, "blue",ifelse(Com1$deff$PPS > -0.5 & Com1$deff$PPS < -0.25, "cyan", ifelse(Com1$deff$PPS >= -0.25 & Com1$deff$PPS <= 0.25, "gold", ifelse(Com1$deff$PPS > 0.25 &Com1$deff$PPS < 0.5, "orange", "red")))), each = 6)
ggplot(DFDEF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDEF$color)
DFDIF <- hex_coord_df(Com1$Comparison$x.x, Com1$Comparison$y.y, Com1$Comparison$ST.y, Com1$Comparison$ST.y, size =1)
DFDIF$Dif <- rep(Com1$Comparison$Diff, each = 6)
DFDIF$color <- rep(ifelse(Com1$Comparison$Diff <= -0.5, "blue",
ifelse(Com1$Comparison$Diff > -0.5 & Com1$Comparison$Diff < -0.25, "cyan",
ifelse(Com1$Comparison$Diff >= -0.25 &Com1$Comparison$Diff <= 0.25, "gold",
ifelse(Com1$Comparison$Diff > 0.25 & Com1$Comparison$Diff < 0.5, "orange", "red")))), each = 6)
ggplot(DFDIF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDIF$color)
Com1 <- ShotComparisonGraph(OffTeam = "San Antonio Spurs", DefTown = "Philadelphia", SeasondataOff = shotDataTotal2016, SeasonDataDef = shotDatafDef2016, nbins = 30, quant = 0.7)
DFOFF <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DFOFF$PPS <- rep(Com1$Off$PPS, each = 6)
DFOFF$color <- rep(ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < -0.25, "cyan", ifelse(Com1$Off$PPS >= -0.25 & Com1$Off$PPS <= 0.25, "gold", ifelse(Com1$Off$PPS > 0.25 &Com1$Off$PPS < 0.5, "orange", "red")))), each = 6)
ggplot(DFOFF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFOFF$color)
DFDEF <- hex_coord_df(Com1$deff$x, Com1$deff$y, Com1$deff$ST, Com1$deff$ST, size =1)
DFDEF$PPS <- rep(Com1$deff$PPS, each = 6)
DFDEF$color <- rep(ifelse(Com1$deff$PPS <= -0.5, "blue",ifelse(Com1$deff$PPS > -0.5 & Com1$deff$PPS < -0.25, "cyan", ifelse(Com1$deff$PPS >= -0.25 & Com1$deff$PPS <= 0.25, "gold", ifelse(Com1$deff$PPS > 0.25 &Com1$deff$PPS < 0.5, "orange", "red")))), each = 6)
ggplot(DFDEF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDEF$color)
DFDIF <- hex_coord_df(Com1$Comparison$x.x, Com1$Comparison$y.y, Com1$Comparison$ST.y, Com1$Comparison$ST.y, size =1)
DFDIF$Dif <- rep(Com1$Comparison$Diff, each = 6)
DFDIF$color <- rep(ifelse(Com1$Comparison$Diff <= -0.5, "blue",
ifelse(Com1$Comparison$Diff > -0.5 & Com1$Comparison$Diff < -0.25, "cyan",
ifelse(Com1$Comparison$Diff >= -0.25 &Com1$Comparison$Diff <= 0.25, "gold",
ifelse(Com1$Comparison$Diff > 0.25 & Com1$Comparison$Diff < 0.5, "orange", "red")))), each = 6)
ggplot(DFDIF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDIF$color)
Com1 <- ShotComparisonGraph(OffTeam = "Toronto Raptors", DefTown = "Cleveland", SeasondataOff = shotDataTotal2016, SeasonDataDef = shotDatafDef2016, nbins = 30, quant = 0.7)
DFOFF <- hex_coord_df(Com1$Off$x, Com1$Off$y, Com1$Off$ST.1, Com1$Off$ST.1, size =1)
DFOFF$PPS <- rep(Com1$Off$PPS, each = 6)
DFOFF$color <- rep(ifelse(Com1$Off$PPS <= -0.5, "blue",ifelse(Com1$Off$PPS > -0.5 & Com1$Off$PPS < -0.25, "cyan", ifelse(Com1$Off$PPS >= -0.25 & Com1$Off$PPS <= 0.25, "gold", ifelse(Com1$Off$PPS > 0.25 &Com1$Off$PPS < 0.5, "orange", "red")))), each = 6)
ggplot(DFOFF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFOFF$color)
DFDEF <- hex_coord_df(Com1$deff$x, Com1$deff$y, Com1$deff$ST, Com1$deff$ST, size =1)
DFDEF$PPS <- rep(Com1$deff$PPS, each = 6)
DFDEF$color <- rep(ifelse(Com1$deff$PPS <= -0.5, "blue",ifelse(Com1$deff$PPS > -0.5 & Com1$deff$PPS < -0.25, "cyan", ifelse(Com1$deff$PPS >= -0.25 & Com1$deff$PPS <= 0.25, "gold", ifelse(Com1$deff$PPS > 0.25 &Com1$deff$PPS < 0.5, "orange", "red")))), each = 6)
ggplot(DFDEF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDEF$color)
DFDIF <- hex_coord_df(Com1$Comparison$x.x, Com1$Comparison$y.y, Com1$Comparison$ST.y, Com1$Comparison$ST.y, size =1)
DFDIF$Dif <- rep(Com1$Comparison$Diff, each = 6)
DFDIF$color <- rep(ifelse(Com1$Comparison$Diff <= -0.5, "blue",
ifelse(Com1$Comparison$Diff > -0.5 & Com1$Comparison$Diff < -0.25, "cyan",
ifelse(Com1$Comparison$Diff >= -0.25 &Com1$Comparison$Diff <= 0.25, "gold",
ifelse(Com1$Comparison$Diff > 0.25 & Com1$Comparison$Diff < 0.5, "orange", "red")))), each = 6)
ggplot(DFDIF, aes(x=x, y = y))+ annotation_custom(court, -250, 250, -52, 418) + geom_polygon(aes(group = id), fill = DFDIF$color)
